{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 39, "column": 0}, "map": {"version":3,"sources":["file:///Users/yorukot/Documents/code/SITCON-CAMP-AIchallenge/history/src/app/%5Bteam%5D/%5Bchall%5D/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { useParams } from \"next/navigation\";\nimport Link from \"next/link\";\n\ninterface ChatHistory {\n  _id: string;\n  team_id: number;\n  timestamp: string;\n  user_input: string;\n  ai_response: string;\n  challenge: string;\n}\n\nexport default function ChallengePage() {\n  const params = useParams();\n  const team = params.team as string;\n  const chall = params.chall as string;\n\n  const [history, setHistory] = useState<ChatHistory[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    fetchHistory(true); // Initial load\n    const interval = setInterval(() => {\n      fetchHistory(false); // Subsequent automatic refreshes\n    }, 2000);\n    return () => clearInterval(interval);\n  }, [team, chall]);\n\n  const fetchHistory = async (isInitialLoad = false) => {\n    try {\n      if (isInitialLoad) {\n        setLoading(true);\n      }\n      const response = await fetch(`/api/history/${team}/${chall}`);\n\n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      setHistory(data);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : \"載入失敗\");\n    } finally {\n      if (isInitialLoad) {\n        setLoading(false);\n      }\n    }\n  };\n\n  const formatTimestamp = (timestamp: string) => {\n    return new Date(timestamp).toLocaleString(\"zh-TW\", {\n      year: \"numeric\",\n      month: \"2-digit\",\n      day: \"2-digit\",\n      hour: \"2-digit\",\n      minute: \"2-digit\",\n      second: \"2-digit\",\n    });\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-black text-green-400 font-mono flex items-center justify-center\">\n        <div className=\"text-xl animate-pulse\">Loading...</div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"min-h-screen bg-black text-red-400 font-mono flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"text-xl mb-4\">Error: {error}</div>\n          <button\n            onClick={() => fetchHistory(true)}\n            className=\"text-white underline hover:text-gray-300\"\n          >\n            [Retry]\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-black text-green-400 p-4\">\n      <div className=\"max-w-7xl mx-auto\">\n        {/* Terminal Window Frame */}\n        <div className=\"bg-gray-800 rounded-t-lg border border-gray-600\">\n          {/* Terminal Header */}\n          <div className=\"bg-gray-700 px-4 py-2 rounded-t-lg flex items-center justify-between\">\n            <div className=\"flex items-center space-x-2\">\n              <div className=\"w-3 h-3 bg-red-500 rounded-full\"></div>\n              <div className=\"w-3 h-3 bg-yellow-500 rounded-full\"></div>\n              <div className=\"w-3 h-3 bg-green-500 rounded-full\"></div>\n            </div>\n            <div className=\"text-gray-300 text-sm font-mono\">\n              SITCON CAMP - Team {team} - {chall.toUpperCase()} History\n            </div>\n            <div className=\"text-gray-500 text-xs\">\n              <Link href=\"/\" className=\"hover:text-gray-300\">[Back to Home]</Link>\n            </div>\n          </div>\n\n          {/* Terminal Body */}\n          <div className=\"bg-black p-6 rounded-b-lg font-mono text-sm leading-relaxed\">\n            {/* Terminal Header Info */}\n            <div className=\"mb-6\">\n              <div className=\"text-green-400\">\n                Welcome to SITCON CAMP History Viewer\n              </div>\n              <div className=\"text-gray-500\">\n                Team: {team} | Challenge: {chall} | Records: {history.length}\n              </div>\n              <div className=\"text-gray-600 text-xs mt-2\">\n                {history.length > 0 && `Last updated: ${formatTimestamp(history[0]?.timestamp)}`}\n              </div>\n              <div className=\"border-t border-gray-700 mt-4 mb-6\"></div>\n            </div>\n\n            {history.length === 0 ? (\n              <div className=\"text-yellow-400\">\n                sitcon@ubuntu:/home/sitcon/history$ ls -la<br/>\n                total 0<br/>\n                <span className=\"text-gray-500\">No conversation records found for Team {team} in {chall}</span>\n              </div>\n            ) : (\n              <div className=\"space-y-8\">\n                {history.map((record, index) => (\n                  <div key={record._id} className=\"space-y-2\">\n                    {/* Session Separator */}\n                    <div className=\"text-gray-600 text-xs border-t border-gray-800 pt-4\">\n                      === Session {history.length - index} | {formatTimestamp(record.timestamp)} ===\n                    </div>\n                    \n                    {/* User Input */}\n                    <div className=\"space-y-1\">\n                      <div className=\"text-green-400\">\n                        <span className=\"text-gray-500\">sitcon@ubuntu:~$</span> {record.user_input}\n                      </div>\n                    </div>\n                    \n                    {/* AI Response as Terminal Output */}\n                    <div className=\"space-y-1 ml-0\">\n                      <div className=\"text-cyan-300 whitespace-pre-wrap break-words leading-relaxed\">\n                        {record.ai_response}\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n            \n            {/* Terminal Footer */}\n            <div className=\"mt-8 pt-4 border-t border-gray-700\">\n              <div className=\"flex items-center space-x-4 text-xs text-gray-500\">\n                <button\n                  onClick={() => fetchHistory(true)}\n                  className=\"text-green-400 hover:text-green-300 underline\"\n                >\n                  [Refresh]\n                </button>\n                <span>•</span>\n                <Link href=\"/\" className=\"text-blue-400 hover:text-blue-300 underline\">\n                  [Home]\n                </Link>\n                <span>•</span>\n                <span>Records: {history.length}</span>\n              </div>\n              \n              {/* Blinking Cursor */}\n              <div className=\"mt-4 flex items-center\">\n                <span className=\"text-green-400\">sitcon@ubuntu:/home/sitcon/history$</span>\n                <span className=\"ml-2 animate-pulse text-green-400\">_</span>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}